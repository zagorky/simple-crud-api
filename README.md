# Simple CRUD API with Load Balancing

## ðŸ“‹ Description

A RESTful API built with Node.js and TypeScript that implements CRUD operations for user management. The application
features a built-in load balancer for horizontal scaling using Node.js Cluster API.

---

## Features

- **RESTful API** with full CRUD operations
- **In-memory database** for fast data access
- **Load balancing** with round-robin request distribution
- **Multi-process architecture** utilizing all available CPU cores
- **TypeScript** for type safety and better developer experience
- **Environment-based configuration** for different deployment scenarios
- **Comprehensive error handling** with appropriate HTTP status codes
- **CORS support** for cross-origin requests
- **Input validation** for all API endpoints

## User Model

```typescript
{
    id: string;        // UUID, generated by the server
    username: string;  // required
    age: number;       // required
    hobbies: string[]; // required (can be empty array)
}
```

## Technical Stack

- **Runtime**: Node.js v24.10.0+
- **Language**: TypeScript 5.9.3
- **Build Tools**:
    - Webpack 5.102.1
    - TypeScript Compiler
- **Development Tools**:
    - ESLint 9.39.1
    - Prettier 3.6.2
    - Jest 30.2.0 for testing
    - Nodemon 3.1.10 for development

## Quick Start

### 1. Clone repository

```bash
  git clone git@github.com:zagorky/simple-crud-api.git
```

### 2. Checkout to the dev branch

```bash
  git checkout dev
```

### 3. Install Dependencies

```bash
  pnpm install
```

### 4. Create .env File

```bash
  cp .env.example .env
```

### 5. Run in Development Mode

```bash
  pnpm start:dev
```

Server will start at `http://localhost:4000`

### 6. Run in Production Mode

```bash
pnpm start:prod
```

Project build via webpack â†’ run `dist/index.js`

### 7. Run in Multi Mode (Cluster)

```bash
pnpm start:multi
```

Load balancer at `http://localhost:3000`, workers on ports 3001, 3002, ...

### 8. Run Tests

```bash
pnpm test
```

---

## Scripts

| Command            | Description                                                          |
|--------------------|----------------------------------------------------------------------|
| `pnpm start:dev`   | Runs the app in development mode with hot reload (`nodemon`)         |
| `pnpm start:prod`  | Builds the project and runs the bundled version                      |
| `pnpm start:multi` | Starts multiple instances using Node.js Cluster API (load balancing) |

---

## Load Balancing Mode (`start:multi`)

Example for `PORT=3000` and 4 CPU cores:

| Role          | Address              |
|---------------|----------------------|
| Load Balancer | `localhost:3000/api` |
| Worker 1      | `localhost:3001/api` |
| Worker 2      | `localhost:3002/api` |
| Worker 3      | `localhost:3003/api` |

- Creates N-1 workers (where N = number of CPU cores)
- The load balancer distributes requests using round-robin
- Database state is synchronized between workers
- Example: 4 CPU â†’ 1 load balancer (3000) + 3 workers (3001, 3002, 3003)

---

## API Endpoints

### GET /api/users

Get all users

```bash
curl http://localhost:4000/api/users
```

### GET /api/users/{userId}

Get user by ID

```bash
curl http://localhost:4000/api/users/{uuid}
```

### POST /api/users

Create a new user

```bash
curl -X POST http://localhost:4000/api/users \
  -H "Content-Type: application/json" \
  -d '{"username":"John","age":30,"hobbies":["reading","gaming"]}'
```

### PUT /api/users/{userId}

Update user

```bash
curl -X PUT http://localhost:4000/api/users/{uuid} \
  -H "Content-Type: application/json" \
  -d '{"username":"Jane","age":25,"hobbies":["coding"]}'
```

### DELETE /api/users/{userId}

Delete user

```bash
curl -X DELETE http://localhost:4000/api/users/{uuid}
```

## User Object Structure

```typescript
{
    id: string;        // UUID, generated by the server
    username: string;  // required field
    age: number;       // required field
    hobbies: string[]; // required field (can be an empty array)
}
```

## Error Handling

The API returns appropriate HTTP status codes and error messages:

| Status Code | Description                                  |
|-------------|----------------------------------------------|
| 200         | OK - Successful GET/PUT request              |
| 201         | Created - User created successfully          |
| 204         | No Content - User deleted successfully       |
| 400         | Bad Request - Invalid input data             |
| 404         | Not Found - User not found                   |
| 500         | Internal Server Error - Something went wrong |

## License

This project is licensed under the ISC License.

## Reference

This project is based on
the [RS School CRUD API assignment](https://github.com/AlreadyBored/nodejs-assignments/blob/main/assignments/crud-api/assignment.md).

---

**Author:** _[zagorky](https://github.com/zagorky)_
**Course:** Node.js 2025
